;/*FB_PKG_DELIM*/

__d("IsWebDriverTestRunning",["WebDriverConfig"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("WebDriverConfig").isTestRunning}g["default"]=a}),98);
__d("UplBundleBillingFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("2380");b=d("FalcoLoggerInternal").create("upl_bundle_billing",a);e=b;g["default"]=e}),98);
__d("BillingAbstractUPLogger",["AdsCurrencyFormatter","IsWebDriverTestRunning","UplBundleBillingFalcoEvent","isStringNullOrEmpty","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(b){var c;this.metadata=babelHelpers["extends"]({context:"billingdefault",platform:"derived",session_id:(c=a.default_static_session)!=null?c:a.generateSessionID()},b);this.wizardMetadata=babelHelpers["extends"]({},b)}var b=a.prototype;b.logEvent=function(a){this.internalLogEvent(a),this.$1()};b.logError=function(a,b){b=babelHelpers["extends"]({},b,{error_name:a,event_result:"fail"});this.internalLogError(b);this.$1()};b.logBillingPayloadError=function(a,b){this.logError(a,{error_code:b.exception_code,error_message:b.exception_message,error_stacktrace:b.error_stacktrace,event_action:(a=(a=b.upl_event)==null?void 0:a.action)!=null?a:"unknown",event_result:"fail",event_side:"client",exception_class:b.exception_class,target_name:(a=(a=(a=b.upl_event)==null?void 0:a.document_name)!=null?a:b.event.event_context)!=null?a:"error_handler"})};b.getSessionID=function(){return this.metadata.session_id};b.internalLogEvent=function(a){var b=this.buildUPLBundleBillingEvent(a);c("IsWebDriverTestRunning")?c("UplBundleBillingFalcoEvent").logRealtimeEvent(function(){return b}):c("UplBundleBillingFalcoEvent").log(function(){return b})};b.internalLogError=function(a){var b=this.buildUPLBundleBillingError(a);c("IsWebDriverTestRunning")?c("UplBundleBillingFalcoEvent").logRealtimeEvent(function(){return b}):c("UplBundleBillingFalcoEvent").log(function(){return b})};b.$1=function(){};b.getLoggingData=function(a){return babelHelpers["extends"]({context:this.metadata.context,credential_id:this.metadata.credential_id,credential_type:this.metadata.credential_type,entry_point:this.metadata.entry_point,external_flow_id:this.metadata.external_flow_id,target_name:a,user_session_id:this.metadata.session_id},this.getLoggingDataImpl())};b.getBasicLoggingData=function(a){return babelHelpers["extends"]({context:this.metadata.context,target_name:a,user_session_id:this.metadata.session_id},this.getBasicLoggingDataImpl())};b.getBasicLoggingDataImpl=function(){return{}};b.getLoggingDataImpl=function(){return{}};a.generateSessionID=function(){return"upl_"+Date.now()+"_"+c("uuidv4")()};b.appendMetadataIfNotNull=function(a){var b={};for(var c in a)if(a[c]!=null){var d;b=babelHelpers["extends"]({},b,(d={},d[c]=a[c],d))}this.metadata=babelHelpers["extends"]({},this.metadata,b)};b.logClickEvent=function(a,b){b={event_action:"click",event_result:"atomic",event_side:"user",extra_data:b,target_name:a};this.logEvent(b)};b.logEditFormEvent=function(a,b){b={event_action:"edit",event_result:"enter",event_side:"user",extra_data:b,target_name:a};this.logEvent(b)};b.buildUPLBundleBillingEvent=function(a,b){var c,d;this.metadata.context.trim()===""&&(this.metadata.context="billingdefault",a.extra_data=babelHelpers["extends"]({},a.extra_data,{debug_info:"Issue:MISSING_EVENT_NAME"}));c=[(c=a.event_side)!=null?c:"client",(c=a.event_action)!=null?c:"unknown",(c=this.metadata.context)!=null?c:"billingdefault",(c=a.event_result)!=null?c:"fail"].join("_");d=babelHelpers["extends"]({entry_point:this.metadata.entry_point,external_flow_id:this.metadata.external_flow_id,is_changed:((d=a.extra_data)==null?void 0:d.is_changed)==="true",is_enabled:!((d=a.is_disabled)!=null?d:!1),payment_account_id:this.metadata.payment_account_id,target_name:a.target_name},b);d={actual_event_time:Date.now().toString(),event_name:c,event_payload:d,extra_data:(b=a.extra_data)!=null?b:void 0,platform:(c=this.metadata.platform)!=null?c:"derived",product_type:"billing",session_id:this.metadata.session_id};return d};b.buildUPLBundleBillingError=function(a,b){var c;b=this.buildUPLBundleBillingEvent(a,b);return babelHelpers["extends"]({},b,{error_code:(c=(c=a.error_code)==null?void 0:c.toString())!=null?c:void 0,error_message:a.error_message,error_stacktrace:(c=a.error_stacktrace)!=null?c:void 0,extra_data:babelHelpers["extends"]({},b.extra_data,{error_category:(c=a.exception_category)!=null?c:"system"})})};b.transformPaymentMethodTypeToUPL=function(a){switch(a){case"NEW_CREDIT_CARD":case"CC":return"CREDIT_CARD";case"NEW_DIRECT_DEBIT":case"DirectDebit":return"DIRECT_DEBIT";case"NEW_PAYPAL_BA":return"PAYPAL_BA";default:return a}};b.parsePaymentAmount=function(a,b){if(c("isStringNullOrEmpty")(a)||c("isStringNullOrEmpty")(b))return null;b=d("AdsCurrencyFormatter").parsePECurrency(b,a);return isNaN(b)?null:b};return a}();a.default_static_session=a.generateSessionID();g["default"]=a}),98);
__d("UPLEventStatus",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({ATOMIC:"atomic",CANCEL:"cancel",COMPLETED:"completed",DISPLAY:"display",ENTER:"enter",EXIT:"exit",EXPIRED:"expired",FAIL:"fail",INIT:"init",PENDING:"pending",RESUMED:"resumed",SCHEDULED:"scheduled",SKIPPED:"skipped",STOPPED:"stopped",SUBMIT:"submit",SUCCESS:"success",UNKNOWN:"unknown",WARNING:"warning"});c=a;f["default"]=c}),66);
__d("BillingWizardUPLoggerImpl",["BillingAbstractUPLogger","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var c;c=a.call(this,{wizard_session_id:b.generateWizardSessionID()})||this;c.screenMetadata={};return c}var d=b.prototype;d.enterWizard=function(a,b,c){a=a;this.appendMetadataIfNotNull({context:b,wizard_name:a});a={event_action:"execute",event_result:"enter",event_side:"client",extra_data:{loggerSession:c},target_name:(b=this.metadata.wizard_name)!=null?b:"enter_wizard"};this.logEvent(a)};d.logClickEvent=function(a,b,c){b=babelHelpers["extends"]({},c,{event_action:"click",event_result:"atomic",event_side:"user",extra_data:b,target_name:(c=a)!=null?c:""});this.logEvent(b)};d.logWizardInitLoadEvent=function(a,b,c,d){var e=a,f;switch(a){case"ADD_PM":case"ADD_PM_NUX":case"ADD_PM_PUX":f="billingaddpm";break;case"ADD_FUNDS":case"IAP_ADD_FUNDS":f="billingaddfunds";break;case"PAY_NOW":f="billingpaynow";break;case"COLLECT_ACCOUNT_INFO":f="billingaccountinfo";break;case"RESOLVE_SDC_FRICTION":f="billingselfresolution";break;case"EDIT_CREDIT_CARD":f="billingcreditcard";break;case"ASSIGN_AD_CREDITS":f="billingcoupon";break;case"UPDATE_ACCOUNT_SPEND_LIMIT":f="billingspendlimits";break;default:f="billingdefault";break}this.appendMetadataIfNotNull({context:f,entry_point:c,external_flow_id:d,payment_account_id:b,view_name:"NONE",wizard_name:e});c={event_action:"execute",event_result:"init",event_side:"client",target_name:a};this.logEvent(c)};d.exitWizard=function(a){var b;b={event_action:"execute",event_result:"exit",event_side:"client",target_name:(b=this.metadata.wizard_name)!=null?b:"exit_wizard",wizardExitType:a};this.logEvent(b);this.clearMetaData()};d.clearMetaData=function(){var a=this.metadata.platform,c=this.metadata.session_id,d=this.metadata.business_id,e=this.metadata.entry_point,f=this.metadata.payment_account_id;this.metadata={business_id:d,context:"billingdefault",entry_point:e,payment_account_id:f,platform:a,session_id:c,wizard_session_id:b.generateWizardSessionID()};this.screenMetadata={}};d.setState=function(a){this.appendMetadataIfNotNull({state:a})};d.setWizardConfig=function(a,b){a=a;this.appendMetadataIfNotNull({context:(b=b)!=null?b:"billingdefault",view_name:a})};d.setWizardMetadata=function(a){this.wizardMetadata=babelHelpers["extends"]({},a)};d.setWizardScreen=function(a){if(this.screenMetadata.sub_screen!==a){var b={event_action:"render",event_result:"display",event_side:"client",target_name:a};this.screenMetadata={sub_screen:a};this.logEvent(b)}};d.getLoggingDataImpl=function(){return{business_id:this.metadata.business_id,entry_point:this.metadata.entry_point,mi_app_id:this.metadata.mi_app_id,org_id:this.metadata.org_id,wizard_config_name:this.metadata.view_name,wizard_name:this.metadata.wizard_name,wizard_screen_name:this.screenMetadata.sub_screen,wizard_session_id:this.metadata.wizard_session_id,wizard_state_name:this.metadata.state}};d.getBasicLoggingDataImpl=function(){return{wizard_session_id:this.metadata.wizard_session_id}};b.generateWizardSessionID=function(){return"upl_wizard_"+Date.now()+"_"+c("uuidv4")()};d.getDifference_TESTONLY=function(a,b){return babelHelpers["extends"]({},Object.fromEntries(Object.entries(b).filter(function(b){var c=b[0];b=b[1];return b!=null&&(!(c in a)||a[c]==null)}).map(function(a){var b=a[0];a=a[1];return[b,"exepected no value but got "+String(a)]})),Object.fromEntries(Object.entries(a).filter(function(a){var c=a[0];a=a[1];return a!=null&&(!(c in b)||b[c]!==a)}).map(function(a){var c=a[0];a=a[1];return[c,"expected "+String(a)+" got "+String(b[c])]})))};d.getDefaultBundleBillingEvent=function(a,b,c){var d=this,e=Array.from(new Set([].concat(Object.keys(this.screenMetadata),Object.keys(this.wizardMetadata),Object.keys(c)))).filter(function(a){return!b.includes(a)});e=e.map(function(b){var e;return[(e=a[b])!=null?e:b,(e=(e=(e=c[b])!=null?e:d.screenMetadata[b])!=null?e:d.wizardMetadata[b])!=null?e:void 0]});return Object.fromEntries(e)};d.buildUPLBundleBillingEvent=function(b,c){var d;return a.prototype.buildUPLBundleBillingEvent.call(this,b,babelHelpers["extends"]({},this.getDefaultBundleBillingEvent({currency:"limit_currency",wizardExitType:"wizard_exit_type"},["credential_type","context","event_action","event_result","event_side","extra_data","wizard_session_id","session_id","platform","exception_class","exception_category","error_stacktrace"],b),{advertising_purpose:b==null?void 0:(d=b.extra_data)==null?void 0:d.advertising_purpose,agency_representing_client:(d=b.is_agency_representing_client)!=null?d:!1,business_tax_id_type:(d=(d=b.extra_data)==null?void 0:(d=d.tax_id_type)==null?void 0:d.toString())!=null?d:"",credential_id:(d=(d=(d=this.screenMetadata.credential_id)!=null?d:this.wizardMetadata.credential_id)!=null?d:b==null?void 0:(d=b.extra_data)==null?void 0:d.credential_id)!=null?d:void 0,credential_type:(d=(d=this.transformPaymentMethodTypeToUPL(this.screenMetadata.credential_type))!=null?d:this.transformPaymentMethodTypeToUPL(this.wizardMetadata.credential_type))!=null?d:void 0,flow_session_id:this.metadata.wizard_session_id,has_written_mandate_form_advertiser:(d=b.has_written_mandate_form_advertiser)!=null?d:!1,is_advertising_for_multiple_clients:(d=b.is_advertising_for_multiple_clients)!=null?d:!1,is_client_paying_invoices:(d=b.is_client_paying_invoices)!=null?d:!1,is_recurring_card:(d=(d=this.screenMetadata.is_credential_recurring)!=null?d:this.wizardMetadata.is_credential_recurring)!=null?d:!1,mi_app_id:(d=this.metadata.mi_app_id)!=null?d:void 0,org_id:(d=this.metadata.org_id)!=null?d:void 0,payment_amount:(d=(d=this.parsePaymentAmount(this.screenMetadata.payment_amount,this.screenMetadata.currency))!=null?d:this.parsePaymentAmount(this.wizardMetadata.payment_amount,this.wizardMetadata.currency))!=null?d:void 0,purchase_order_number:(d=(d=b.extra_data)==null?void 0:d.purchase_order_number)!=null?d:void 0,state:(d=this.metadata.state)!=null?d:void 0,target_url:(d=(d=b.extra_data)==null?void 0:d.target_url)!=null?d:void 0,timezone:(b=(d=b.extra_data)==null?void 0:d.timezone)!=null?b:void 0,wizard_name:(d=this.metadata.wizard_name)!=null?d:void 0,wizard_state_name:(b=this.metadata.state)!=null?b:void 0},c))};d.logQueryEvent=function(a,b,c,d){d=babelHelpers["extends"]({event_action:"fetch",event_result:d,event_side:"client",extra_data:b,target_name:a},c);this.logEvent(d)};d.logQueryError=function(a,b,c,d){c={error_code:d.errorPayload.exception_code,error_message:d.message,event_action:"fetch",event_result:"fail",event_side:"client",extra_data:b,target_name:a};this.logError(d.type,c)};d.logMutationEvent=function(a,b,c,d){d=babelHelpers["extends"]({event_action:"mutate",event_result:d,event_side:"client",extra_data:b,target_name:a},c);this.logEvent(d)};d.logMutationError=function(a,b,c,d){c={error_code:d.errorPayload.exception_code,error_message:d.message,event_action:"mutate",event_result:"fail",event_side:"client",extra_data:b,target_name:a};this.logError(d.type,c)};d.appendScreenMetadata=function(a){var b={};for(var c in a)if(a[c]!=null){var d;b=babelHelpers["extends"]({},b,(d={},d[c]=a[c],d))}this.screenMetadata=babelHelpers["extends"]({},this.screenMetadata,b)};d.appendMetadataIfNotNull=function(b){var c={};for(var d in b)if(b[d]!=null){var e;c=babelHelpers["extends"]({},c,(e={},e[d]=b[d],e))}this.screenMetadata=babelHelpers["extends"]({},this.screenMetadata,c);a.prototype.appendMetadataIfNotNull.call(this,b)};d.setQE=function(a){this.billingQE=a};return b}(c("BillingAbstractUPLogger"));g["default"]=a}),98);
__d("BillingUPLWizardWebLogger",["BillingWizardUPLoggerImpl"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(c("BillingWizardUPLoggerImpl"));b=new a();d=b;g["default"]=d}),98);